NUM_DEVICES: 2
TASK: 'sta' 
SAVE_TOP_K: 1
# CHECKPOINT_FILE_PATH: '/home/sanketthakur/Documents/Work/stillfast/output/sta/StillFast_default/version_1/checkpoints/last.ckpt'
DATA:
  STILL:
    MIN_SIZE: [640, 672, 704, 736, 768, 800]
    MAX_SIZE: 1333
    FAST_TO_STILL_SIZE_RATIO: 0.32
  FAST:
    NUM_FRAMES: 16
    SAMPLING_RATE: 1
MODEL:
  NAME: StillFast
  NOUN_CLASSES: 128
  VERB_CLASSES: 81
  BRANCH: "StillFast"
  GAIT_ATTN_LAYERS: [4]
  NUM_FRAMES: 16
  MAX_OBJ: 10
  LOSS:
    WEIGHTS:
      NOUN: 1.0
      VERB: 0.2
      TTC: 1.0 
  STILL:
    PRETRAINED: True
    REPLACE_HEAD: True
    BACKBONE:
      NAME: resnet50
      PRETRAINED: True
    BOX:
      POOLER_SAMPLING_RATIO: 0
  FAST:
    BACKBONE:
      NAME: x3d_m
      PRETRAINED: True
  STILLFAST:
    ROI_HEADS:
      VERSION: v2
      V2_OPTIONS:
        FUSION: concat_residual
    FUSION:
      FUSION_BLOCK: convolutional
      CONVOLUTIONAL_FUSION_BLOCK:
        POOLING: mean
        CONV_BLOCK_ARCHITECTURE: simple_convolution
        POST_UP_CONV_BLOCK: True
        POST_SUM_CONV_BLOCK: True
        GATING_BLOCK: 'None'
      POST_PYRAMID_FUSION: False
      PRE_PYRAMID_FUSION: True     
      LATERAL_CONNECTIONS: False
SOLVER:
  BASE_LR: 0.0001
  WEIGHT_DECAY: 0.0001
  MAX_EPOCH: 20
  OPTIMIZING_METHOD: sgd
  LR_POLICY: multistep_warmup
  GAMMA: 0.1
  WARMUP_STEPS: 2000
  MILESTONES: [15, 30]
  PRECISION: 16
EGO4D_STA:
  STILL_FRAMES_PATH: "/data/ego4d_data/v1/full_scale/short_term_anticipation/data/comp_lmdb/"
  FAST_LMDB_PATH: "/data/ego4d_data/v1/full_scale/short_term_anticipation/data/comp_lmdb/"
  ANNOTATION_DIR: "/data/ego4d_data/v2/annotations/"
  OBJECT_DETECTIONS: "/data/ego4d_data/v2/ego_obj_detections/"
  TRAIN_LISTS: [fho_sta_train.json] 
  VAL_LISTS: [fho_sta_val.json]
  TEST_LISTS: [fho_sta_test_unannotated.json]

TRAIN:
  BATCH_SIZE: 2
  DATASET: "Ego4dShortTermAnticipationStillVideo"
  AUGMENTATIONS:
    RANDOM_HORIZONTAL_FLIP: True

VAL:
  DATASET: "Ego4dShortTermAnticipationStillVideo"
  BATCH_SIZE: 8
  GROUP_BATCH_SAMPLER: False

TEST:
  DATASET: "Ego4dShortTermAnticipationStillVideo"
  BATCH_SIZE: 8

DATA_LOADER:
  NUM_WORKERS: 4

#      Validate metric           DataLoader 0
# ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
#   map_box_noun_verb_ttc     2.1292091531365576
#        val/ap_box            26.9988441029282
#      val/ap_box_noun        14.550033477803165
#    val/ap_box_noun_ttc       4.775649122760311
#   val/ap_box_noun_verb       6.309832978156285
# val/ap_box_noun_verb_ttc    2.2561269597301625
#      val/ap_box_ttc          9.233236005820736
#      val/ap_box_verb         10.91280187801086
#    val/ap_box_verb_ttc       4.14944246221692
#     val/map_box_noun         11.19289307924555
#   val/map_box_noun_ttc       3.940750521652993
#   val/map_box_noun_verb      5.580597681615868
# val/map_box_noun_verb_ttc   2.1292091531365576

  
